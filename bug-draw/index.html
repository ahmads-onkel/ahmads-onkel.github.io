<!DOCTYPE html>
<html>
<head>
<title>Name Bug</title>
<style>
body{
    background:#eaeaea;
    display:flex;
    flex-direction:column;
    align-items:center;
    font-family:sans-serif;
}
canvas{
    background:white;
    border:3px solid black;
}
input{
    margin:20px;
    padding:10px;
    font-size:24px;
    width:350px;
}
</style>
</head>
<body>

<input id="nameInput" placeholder="Type your name and press Enter">
<canvas id="canvas" width="900" height="400"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const input = document.getElementById("nameInput");

let path = [];
let drawing = false;

input.addEventListener("keydown", e=>{
    if(e.key === "Enter"){
        generate(e.target.value);
    }
});

function generate(text){

    ctx.clearRect(0,0,900,400);

    // Unsichtbaren Text rendern
    ctx.fillStyle="black";
    ctx.font="bold 180px Arial";
    ctx.textAlign="center";
    ctx.textBaseline="middle";
    ctx.fillText(text,450,200);

    const imageData = ctx.getImageData(0,0,900,400);
    ctx.clearRect(0,0,900,400);

    path=[];

    for(let y=0;y<400;y+=3){
        for(let x=0;x<900;x+=3){
            let i=(y*900+x)*4;
            if(imageData.data[i+3]>128){
                path.push({x,y});
            }
        }
    }

    // Sort left to right for clean drawing
    path.sort((a,b)=>a.x-b.x);

    animateBug();
}

function animateBug(){

    if(drawing) return;
    drawing=true;

    let i=0;
    let current=path[0];

    ctx.lineWidth=2;
    ctx.lineCap="round";
    ctx.strokeStyle="black";

    function step(){

        if(i>=path.length){
            drawing=false;
            return;
        }

        let target=path[i];

        let dx=target.x-current.x;
        let dy=target.y-current.y;
        let dist=Math.sqrt(dx*dx+dy*dy);

        if(dist<1){
            i++;
        } else {

            let speed=2;

            let vx=dx/dist*speed;
            let vy=dy/dist*speed;

            let prevX=current.x;
            let prevY=current.y;

            current.x+=vx;
            current.y+=vy;

            // Draw trail
            ctx.beginPath();
            ctx.moveTo(prevX,prevY);
            ctx.lineTo(current.x,current.y);
            ctx.stroke();

            // Draw bug body
            drawBug(current.x,current.y,vx,vy);
        }

        requestAnimationFrame(step);
    }

    step();
}

function drawBug(x,y,vx,vy){

    let angle=Math.atan2(vy,vx);

    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(angle);

    // Body
    ctx.fillStyle="black";
    ctx.beginPath();
    ctx.ellipse(0,0,8,5,0,0,Math.PI*2);
    ctx.fill();

    // Head
    ctx.beginPath();
    ctx.arc(8,0,4,0,Math.PI*2);
    ctx.fill();

    // Antennae
    ctx.beginPath();
    ctx.moveTo(10,-3);
    ctx.lineTo(14,-8);
    ctx.moveTo(10,3);
    ctx.lineTo(14,8);
    ctx.stroke();

    ctx.restore();
}
</script>

</body>
</html>
