<!DOCTYPE html>
<html>
<head>
<title>Line Image Generator</title>
<style>
body{
    background:#111;
    display:flex;
    flex-direction:column;
    align-items:center;
    font-family:sans-serif;
}
canvas{
    background:white;
    border:2px solid #444;
}
input{
    margin:20px;
    padding:10px;
    font-size:20px;
    width:300px;
}
</style>
</head>
<body>

<input id="textInput" placeholder="type word and press enter"/>
<canvas id="canvas" width="700" height="700"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const input = document.getElementById("textInput");

let points = [];
let drawing = false;

input.addEventListener("keydown", e=>{
    if(e.key === "Enter"){
        generate(input.value);
    }
});

function generate(text){

    ctx.clearRect(0,0,700,700);

    // Text unsichtbar rendern
    ctx.fillStyle = "black";
    ctx.font = "bold 200px Arial";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText(text,350,350);

    const imageData = ctx.getImageData(0,0,700,700);
    ctx.clearRect(0,0,700,700);

    points = [];

    for(let y=0;y<700;y+=4){
        for(let x=0;x<700;x+=4){
            const index = (y*700 + x)*4;
            const alpha = imageData.data[index+3];
            if(alpha > 128){
                points.push({x,y});
            }
        }
    }

    shuffle(points);
    animate();
}

function shuffle(array){
    for(let i=array.length-1;i>0;i--){
        let j=Math.floor(Math.random()*(i+1));
        [array[i],array[j]]=[array[j],array[i]];
    }
}

function animate(){

    if(drawing) return;
    drawing=true;

    ctx.lineWidth=1;
    ctx.lineCap="round";
    ctx.strokeStyle="black";

    let i=0;

    function step(){

        for(let k=0;k<80 && i<points.length;k++,i++){

            let p=points[i];

            ctx.beginPath();
            ctx.moveTo(p.x,p.y);
            ctx.lineTo(
                p.x + (Math.random()-0.5)*20,
                p.y + (Math.random()-0.5)*20
            );
            ctx.stroke();
        }

        if(i<points.length){
            requestAnimationFrame(step);
        } else {
            drawing=false;
        }
    }

    step();
}
</script>

</body>
</html>
